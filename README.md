# 概要
東方の旧作など、PC-98時代のゲームでは、PMDというシェアウェアのFM音源ドライバ（※ドライバ本体はフリーでMMLコンパイラが有料）がよく使われていました。PMDは、個人の方（KAJAさん）が作られたものですが、同人ゲームに限らず商用パッケージでも使われていたシロモノで、私も生まれて初めて購入したシェアウェアがPMDのMMLコンパイラだったりします。ちなみに、当時は郵便小為替で料金を支払って購入。TAKERUとかで売られていればもっと手軽に手に入ったのですが...

ところで、ファイル数が多いとファイルシステムの仕様上、無駄セクタ領域が発生してしまうので、音楽やグラフィックなどのデータファイルは１つのファイルに纏める方式がよく採られます。ストレージのビット単価が高かったり、1.25MBのFDにデータを収める必要があった当時は、この方式の使用がほぼMUSTでした（全部が全部ではなかったけど）。
> なお、ファイル数が多くなると無駄領域が発生することは現代でも変わりない（むしろ、ファイルシステムの仕様上、無駄領域のサイズが大きくなっている）ので、この技術は現代でも有効です。スマホアプリの場合、配付時はapk（Android）やipa（iOS）など、１つのファイルに纏められますが、インストール後は内部的に展開後の状態で保持される（そうしないと起動に時間が掛かるし記憶領域の書込損耗が無駄に多くなってしまう）ので、この方式はスマホアプリでも容量削減という意味で結構有効です。もっとも、普通に参考書を読んでアプリを作っていると絶対に身につかない技術だと思うので、やっているのは一部の変態プログラマだけですが（^^;

だから当時、PMDを採用しているゲームディスクから音楽データを抽出する作業を楽にするためのツールを自前で作ったりして遊んだりしていました。そして、最近再びPMDの音楽データを抜き出す作業が必要になったので、当時を思い出しながらツールを作ってみましたので、ソースを共有しておきます。

# 使い方
- Cコンパイラ（OSは不問）で extract.c をコンパイル

> vc++ならコマンドラインで CL /MT extract.c とか。

- extract <i>PMDが含まれるファイル</i> を実行
- song<i>xxxx</i>.m というファイル名で一括抽出されます

（補足）
- songxxxx.mの末尾には余分なデータがくっついている可能性があります。（たぶん、無視されると思うので問題無い）
- 誤抽出される（ごみデータが抽出される）可能性もあります。
- 実際にPMDで鳴らすなりして確認しましょう。
- WindowsであればWinPMDとかで聴けると思います。
